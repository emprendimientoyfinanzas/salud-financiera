<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz Indicador de salud financiera Juvenil</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
  </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900">

  <div id="root"></div>

  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    // --- DATOS Y CONFIGURACI√ìN ---
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxCImROK3qi3RxqXBX0ptOahRgGaVaggATDkahIqkf039CS_08br7W-Ie9GHIfpslu7/exec"; //

    // --- PREGUNTAS CON EMOTICONOS Y PONDERACI√ìN ---
    const quizData = [
      // SECCI√ìN A
      { questionText: 'ü§ë Si tus pap√°s te dan $50,000 extra por buenas calificaciones, ¬øqu√© har√≠as primero?', answerOptions: [{ text: 'Guardarlo para algo importante que quiero comprar m√°s adelante', scoreValue: 3 }, { text: 'Ahorrar una parte y gastar el resto en cosas que me gustan', scoreValue: 2 }, { text: 'Preguntarles a mis amigos qu√© har√≠an ellos', scoreValue: 1 }, { text: 'Gastarlo inmediatamente en algo que me guste', scoreValue: 0 }] },
      { questionText: 'ü§î ¬øCon qu√© frecuencia sabes exactamente cu√°nto dinero tienes disponible?', answerOptions: [{ text: 'Siempre s√© cu√°nto tengo guardado y cu√°nto puedo gastar', scoreValue: 3 }, { text: 'Generalmente tengo una idea aproximada', scoreValue: 2 }, { text: 'Solo cuando necesito comprar algo importante', scoreValue: 1 }, { text: 'Casi nunca lo s√© con exactitud', scoreValue: 0 }] },
      { questionText: 'üéÆ Cuando quieres comprar algo que cuesta m√°s de $100,000, ¬øqu√© haces?', answerOptions: [{ text: 'Planifico desde antes c√≥mo conseguir el dinero y cu√°ndo comprarlo', scoreValue: 3 }, { text: 'Espero a tener suficiente dinero ahorrado', scoreValue: 2 }, { text: 'Les pido dinero prestado a mis pap√°s', scoreValue: 1 }, { text: 'Lo compro aunque no tenga todo el dinero', scoreValue: 0 }] },
      { questionText: 'üßë‚Äçü§ù‚Äçüßë Cuando tus amigos van a comprar algo y no tienes dinero suficiente, ¬øqu√© haces?', answerOptions: [{ text: 'Les digo que no puedo y propongo otra actividad', scoreValue: 3 }, { text: 'Voy con ellos pero no compro nada', scoreValue: 2 }, { text: 'Pido dinero prestado para acompa√±arlos', scoreValue: 1 }, { text: 'Compro aunque me quede sin dinero para la semana', scoreValue: 0 }] },
      // SECCI√ìN B
      { questionText: 'üí∞ ¬øDe d√≥nde proviene principalmente tu dinero?', answerOptions: [{ text: 'Trabajo de medio tiempo + mesada/regalo ocasional', scoreValue: 3 }, { text: 'Trabajos espor√°dicos (cuidar ni√±os, vender algo, etc.)', scoreValue: 2 }, { text: 'Solo de mesada o dinero que me dan mis pap√°s', scoreValue: 1 }, { text: 'Pido dinero cuando lo necesito', scoreValue: 0 }] },
      { questionText: 'üÜò Si necesitaras $80,000 para una emergencia, ¬øpodr√≠as conseguirlos?', answerOptions: [{ text: 'S√≠, tengo dinero ahorrado para esas situaciones', scoreValue: 3 }, { text: 'S√≠, combinando ahorros y pidiendo un poco prestado', scoreValue: 2 }, { text: 'Solo si mis pap√°s me ayudan', scoreValue: 1 }, { text: 'Me ser√≠a muy dif√≠cil conseguir esa cantidad', scoreValue: 0 }] },
      { questionText: 'üóìÔ∏è ¬øQu√© tan regular es el dinero que recibes?', answerOptions: [{ text: 'Recibo una cantidad fija cada semana/mes', scoreValue: 3 }, { text: 'Recibo dinero regularmente, pero var√≠a la cantidad', scoreValue: 2 }, { text: 'Solo recibo dinero ocasionalmente', scoreValue: 1 }, { text: 'Es muy irregular, nunca s√© cu√°ndo recibir√© dinero', scoreValue: 0 }] },
      // SECCI√ìN C (PONDERADA)
      { questionText: 'üí∏ ¬øQu√© haces con el dinero que te sobra?', answerOptions: [{ text: 'Siempre guardo una parte fija antes de gastar', scoreValue: 5 }, { text: 'Guardo lo que me sobra despu√©s de mis gastos', scoreValue: 3 }, { text: 'A veces guardo algo, a veces no', scoreValue: 1 }, { text: 'Generalmente no me sobra dinero', scoreValue: 0 }] },
      { questionText: 'üê∑ ¬øD√≥nde guardas tu dinero ahorrado?', answerOptions: [{ text: 'En una cuenta de ahorros o lugar muy seguro', scoreValue: 5 }, { text: 'En una alcanc√≠a o caja fuerte en casa', scoreValue: 3 }, { text: 'En mi billetera o en un lugar f√°cil de acceder', scoreValue: 1 }, { text: 'No ahorro regularmente', scoreValue: 0 }] },
      { questionText: 'üéØ ¬øTienes una meta espec√≠fica para tus ahorros?', answerOptions: [{ text: 'S√≠, tengo metas claras (universidad, celular, viaje, etc.)', scoreValue: 5 }, { text: 'Tengo una idea general de para qu√© quiero ahorrar', scoreValue: 3 }, { text: 'Ahorro "por si acaso" pero sin meta espec√≠fica', scoreValue: 1 }, { text: 'No tengo metas de ahorro', scoreValue: 0 }] },
      // SECCI√ìN D (PONDERADA)
      { questionText: 'üìù ¬øLlevas alg√∫n registro de en qu√© gastas tu dinero?', answerOptions: [{ text: 'Anoto o recuerdo todos mis gastos importantes', scoreValue: 5 }, { text: 'Tengo una idea general de mis gastos principales', scoreValue: 3 }, { text: 'Solo recuerdo los gastos grandes', scoreValue: 1 }, { text: 'No llevo control de mis gastos', scoreValue: 0 }] },
      { questionText: '‚öñÔ∏è Con dinero limitado, ¬øc√≥mo decides en qu√© gastarlo?', answerOptions: [{ text: 'Primero lo necesario, luego lo que quiero', scoreValue: 5 }, { text: 'Trato de balancear entre necesidades y gustos', scoreValue: 3 }, { text: 'Depende de mi estado de √°nimo del momento', scoreValue: 1 }, { text: 'Generalmente compro lo que m√°s me guste', scoreValue: 0 }] },
      { questionText: 'üõçÔ∏è ¬øQu√© tan frecuente es que compres algo sin haberlo planeado?', answerOptions: [{ text: 'Muy rara vez, casi siempre planifico mis compras', scoreValue: 5 }, { text: 'Ocasionalmente, pero solo cosas peque√±as', scoreValue: 3 }, { text: 'Bastante seguido, especialmente si me gusta mucho', scoreValue: 1 }, { text: 'Muy seguido, es dif√≠cil resistir cuando veo algo que me gusta', scoreValue: 0 }] },
      // SECCI√ìN E
      { questionText: 'üß† ¬øCu√°l es tu nivel de comprensi√≥n sobre: inter√©s, inflaci√≥n, riesgo financiero?', answerOptions: [{ text: 'Entiendo bien los tres conceptos', scoreValue: 3 }, { text: 'Entiendo algunos conceptos b√°sicamente', scoreValue: 2 }, { text: 'He escuchado los t√©rminos pero no estoy seguro/a', scoreValue: 1 }, { text: 'No estoy familiarizado/a con estos t√©rminos', scoreValue: 0 }] },
      { questionText: 'üí≥ ¬øQu√© sabes sobre cuentas de ahorro, tarjetas d√©bito y cr√©dito?', answerOptions: [{ text: 'Conozco las diferencias y c√≥mo funcionan', scoreValue: 3 }, { text: 'Tengo conocimiento b√°sico de algunos', scoreValue: 2 }, { text: 'He escuchado de ellos pero no s√© las diferencias', scoreValue: 1 }, { text: 'No s√© mucho sobre productos financieros', scoreValue: 0 }] },
      { questionText: 'üôã Cuando tienes dudas sobre dinero, ¬øqu√© haces?', answerOptions: [{ text: 'Busco informaci√≥n confiable o pregunto a expertos', scoreValue: 3 }, { text: 'Les pregunto a mis pap√°s o familiares', scoreValue: 2 }, { text: 'Les pregunto a mis amigos', scoreValue: 1 }, { text: 'Generalmente no busco ayuda', scoreValue: 0 }] },
      { questionText: 'üì± ¬øUsas apps o herramientas digitales para manejar tu dinero?', answerOptions: [{ text: 'S√≠, uso apps de bancos o de presupuesto', scoreValue: 3 }, { text: 'A veces uso apps para revisar saldo o ahorrar', scoreValue: 2 }, { text: 'Muy pocas veces', scoreValue: 1 }, { text: 'No uso ninguna aplicaci√≥n para mis finanzas', scoreValue: 0 }] },
      // SECCI√ìN F
      { questionText: 'üéì ¬øHas pensado en c√≥mo financiar tus estudios despu√©s del colegio?', answerOptions: [{ text: 'S√≠, tengo un plan claro con mis pap√°s', scoreValue: 3 }, { text: 'He pensado en algunas opciones generales', scoreValue: 2 }, { text: 'Un poco, pero no tengo un plan definido', scoreValue: 1 }, { text: 'No he pensado seriamente en eso todav√≠a', scoreValue: 0 }] },
      { questionText: 'üíº ¬øQu√© opinas sobre trabajar mientras estudias?', answerOptions: [{ text: 'Es buena idea para aprender a manejar dinero y ganar experiencia', scoreValue: 3 }, { text: 'Est√° bien si no interfiere con los estudios', scoreValue: 2 }, { text: 'Prefiero enfocarme solo en estudiar', scoreValue: 1 }, { text: 'No he pensado en trabajar mientras estudio', scoreValue: 0 }] },
      { questionText: 'üöÄ ¬øCu√°l es tu principal meta financiera para los pr√≥ximos 2-3 a√±os?', answerOptions: [{ text: 'Ahorrar para mi educaci√≥n y tener independencia gradual', scoreValue: 3 }, { text: 'Ahorrar para comprar algo importante (ej: computador)', scoreValue: 2 }, { text: 'Tener dinero suficiente para mis gastos personales', scoreValue: 1 }, { text: 'No tengo metas financieras espec√≠ficas', scoreValue: 0 }] },
      { questionText: 'üí™ ¬øQu√© tan preparado/a te sientes para manejar tus finanzas como adulto/a?', answerOptions: [{ text: 'Muy preparado/a, s√© lo b√°sico y puedo aprender m√°s', scoreValue: 3 }, { text: 'Bastante preparado/a, aunque necesito aprender m√°s', scoreValue: 2 }, { text: 'Un poco preparado/a, me falta mucho por aprender', scoreValue: 1 }, { text: 'No me siento preparado/a, me da miedo manejar dinero solo/a', scoreValue: 0 }] },
    ];
    
    // Lista de grados para el men√∫ desplegable
    const gradeOptions = [
      '10A', '10B', '10C', '10D', '10E',
      '11A', '11B', '11C', '11D', '11E'
    ];

    const interpretations = {
      experto: { title: 'üíé Experto Financiero Juvenil', description: '¬°Felicitaciones! Tienes un control incre√≠ble sobre tu dinero. Entiendes la importancia de ahorrar, planificar y tomar decisiones inteligentes. Est√°s construyendo una base muy s√≥lida para tu futuro financiero.', plan: ['Considera aprender sobre inversiones para j√≥venes.', 'Ayuda a tus amigos a entender mejor sus finanzas.', 'Ponte metas de ahorro m√°s grandes y a largo plazo.'] },
      buenManejo: { title: '‚≠ê Buen Manejo Financiero', description: '¬°Vas por un excelente camino! Tienes buenos h√°bitos, aunque todav√≠a hay espacio para mejorar la consistencia. Sigue as√≠ y pronto ser√°s un experto.', plan: ['Intenta crear un presupuesto simple para saber a d√≥nde va tu dinero.', 'Define una meta de ahorro espec√≠fica (ej: para un viaje, un dispositivo, etc.).', 'Antes de comprar algo, espera 24 horas para decidir si realmente lo necesitas.'] },
      enDesarrollo: { title: 'üìà En Desarrollo', description: 'Est√°s empezando a entender c√≥mo funciona el dinero, pero a veces tomas decisiones impulsivas. Es el momento perfecto para fortalecer tus h√°bitos y tomar m√°s control.', plan: ['Lleva un registro de tus gastos durante una semana.', 'Separa una peque√±a cantidad para ahorrar tan pronto recibas dinero.', 'Habla con tus padres o un adulto de confianza sobre c√≥mo manejan su dinero.'] },
      necesitasApoyo: { title: '‚ö†Ô∏è Necesitas Apoyo', description: 'Parece que el manejo del dinero te resulta un poco complicado ahora mismo. No te preocupes, todos empezamos en alg√∫n punto. Con un poco de gu√≠a y pr√°ctica, puedes mejorar much√≠simo.', plan: ['Empieza por lo b√°sico: diferencia entre "querer" y "necesitar".', 'Ponte una meta muy peque√±a de ahorro, como guardar $5,000 pesos a la semana.', 'Busca videos o blogs sencillos sobre finanzas para j√≥venes.'] },
      nivelInicial: { title: 'üö® Nivel Inicial', description: 'Manejar el dinero puede parecer abrumador, y es normal sentirse as√≠. El primer paso es querer aprender. Est√°s en el punto de partida ideal para construir un futuro financiero incre√≠ble.', plan: ['No tengas miedo de preguntar. Habla con un adulto sobre tus dudas.', 'Enf√≥cate en un solo objetivo: saber cu√°nto dinero tienes y en qu√© lo gastas.', 'Celebra los peque√±os logros, como ahorrar tus primeros $10,000 pesos.'] }
    };

    const getResultForScore = (score) => {
      if (score >= 60) return interpretations.experto;
      if (score >= 50) return interpretations.buenManejo;
      if (score >= 40) return interpretations.enDesarrollo;
      if (score >= 30) return interpretations.necesitasApoyo;
      return interpretations.nivelInicial;
    };
    
    // --- COMPONENTES DE REACT ---

    function WelcomeScreen({ onStartQuiz }) {
      return (
        <div className="flex flex-col items-center justify-center text-center p-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg w-full max-w-xl animate-fade-in">
          <h1 className="text-3xl sm:text-4xl font-extrabold text-gray-900 dark:text-white mb-4">Quiz de Salud Financiera Juvenil</h1>
          <p className="text-lg sm:text-xl text-gray-700 dark:text-gray-300 mb-6">Responde a estas {quizData.length} preguntas para evaluar tu salud financiera y obt√©n un plan de acci√≥n para mejorar.</p>
          <button onClick={onStartQuiz} className="px-6 py-3 text-lg font-semibold text-white bg-indigo-600 rounded-full shadow-lg hover:bg-indigo-700 transition-colors duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">Comenzar Quiz</button>
        </div>
      );
    }

    function QuizScreen({ question, questionIndex, totalQuestions, onAnswer }) {
      const { useMemo } = React;
      const shuffledAnswers = useMemo(() => [...question.answerOptions].sort(() => Math.random() - 0.5), [question]);

      return (
        <div className="flex flex-col p-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg w-full max-w-xl animate-fade-in">
          <div className="text-xl sm:text-2xl font-bold text-indigo-600 dark:text-indigo-400 mb-4">
            <span>Pregunta {questionIndex + 1}</span>/{totalQuestions}
          </div>
          <div className="text-2xl sm:text-3xl font-semibold text-gray-900 dark:text-white mb-6">{question.questionText}</div>
          <div className="flex flex-col gap-4">
            {shuffledAnswers.map((option, index) => (
              <button key={index} onClick={() => onAnswer(option.scoreValue)} className="p-4 text-left text-lg text-gray-800 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 rounded-lg shadow-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                {option.text}
              </button>
            ))}
          </div>
        </div>
      );
    }

    // --- COMPONENTE DE FORMULARIO ACTUALIZADO CON MEN√ö DESPLEGABLE ---
    function UserInfoScreen({ onSubmit }) {
      const [name, setName] = React.useState('');
      const [email, setEmail] = React.useState('');
      const [school, setSchool] = React.useState('');
      const [grade, setGrade] = React.useState(''); // El estado inicial es un string vac√≠o
      const [emailError, setEmailError] = React.useState('');

      const validateEmail = (email) => {
        if (!email) return false;
        const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
      };

      const handleEmailChange = (e) => {
        const newEmail = e.target.value;
        setEmail(newEmail);
        if (validateEmail(newEmail) || newEmail === '') {
          setEmailError('');
        } else {
          setEmailError('Por favor, ingresa un correo v√°lido.');
        }
      };
      
      const isFormValid = name.trim() && validateEmail(email) && school.trim() && grade.trim();

      return (
        <div className="flex flex-col items-center justify-center text-center p-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg w-full max-w-xl animate-fade-in">
          <h2 className="text-3xl font-extrabold text-gray-900 dark:text-white mb-4">¬°Casi listo!</h2>
          <p className="text-lg text-gray-700 dark:text-gray-300 mb-6">Ingresa tus datos para guardar y ver tus resultados.</p>
          <div className="w-full flex flex-col gap-4">
            <input type="text" value={name} onChange={(e) => setName(e.target.value)} placeholder="Escribe tu nombre completo" className="w-full p-3 text-center border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" />
            <input type="email" value={email} onChange={handleEmailChange} placeholder="Escribe tu correo electr√≥nico" className={`w-full p-3 text-center border rounded-lg focus:ring-2 ${emailError ? 'border-red-500 focus:ring-red-500' : 'border-gray-300 focus:ring-indigo-500'}`} />
            {emailError && <p className="text-red-500 text-sm mt-[-10px]">{emailError}</p>}
            <input type="text" value={school} onChange={(e) => setSchool(e.target.value)} placeholder="Nombre Instituci√≥n Educativa" className="w-full p-3 text-center border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" />
            
            {/* --- CAMPO DE GRADO CONVERTIDO A <select> --- */}
            <select
              value={grade}
              onChange={(e) => setGrade(e.target.value)}
              className={`w-full p-3 text-center border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 appearance-none ${!grade ? 'text-gray-400 dark:text-gray-500' : 'text-gray-900 dark:text-gray-200'}`}
            >
              <option value="" disabled>-- Selecciona tu grado --</option>
              {gradeOptions.map(optionValue => (
                <option key={optionValue} value={optionValue} className="text-black">{optionValue}</option>
              ))}
            </select>
          </div>
          <button onClick={() => onSubmit(name, email, school, grade)} disabled={!isFormValid} className="mt-6 px-6 py-3 text-lg font-semibold text-white bg-indigo-600 rounded-full shadow-lg hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors">Ver mis Resultados</button>
        </div>
      );
    }
    
    function ResultsScreen({ score, result, onRestart, submissionStatus }) {
      const resultColor = result.title.includes('Experto') ? 'text-cyan-400' : result.title.includes('Buen Manejo') ? 'text-green-400' : result.title.includes('Desarrollo') ? 'text-yellow-400' : result.title.includes('Apoyo') ? 'text-orange-400' : 'text-red-400';
      const resultBg = result.title.includes('Experto') ? 'bg-cyan-900' : result.title.includes('Buen Manejo') ? 'bg-green-900' : result.title.includes('Desarrollo') ? 'bg-yellow-900' : result.title.includes('Apoyo') ? 'bg-orange-900' : 'bg-red-900';
      const maxScore = quizData.reduce((sum, q) => sum + Math.max(...q.answerOptions.map(opt => opt.scoreValue)), 0);
      
      return (
        <div className="flex flex-col items-center text-center p-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg w-full max-w-xl animate-fade-in">
          <h2 className="text-3xl sm:text-4xl font-extrabold text-gray-900 dark:text-white mb-2">¬°Quiz Finalizado!</h2>
          {submissionStatus === 'success' && <p className="text-green-500 mb-4">Tus resultados han sido guardados.</p>}
          {submissionStatus === 'error' && <p className="text-red-500 mb-4">Hubo un error al guardar. A√∫n puedes ver tus resultados.</p>}
          <p className="text-lg sm:text-2xl text-gray-700 dark:text-gray-300 mb-2">Tu puntuaci√≥n total es: <span className="font-bold text-indigo-600 dark:text-indigo-400">{score}</span> de {maxScore}</p>
          <div className={`p-6 rounded-lg my-6 w-full text-left bg-opacity-20 ${resultBg}`}>
            <h3 className={`text-3xl font-extrabold ${resultColor} mb-2`}>{result.title}</h3>
            <p className="text-lg text-gray-700 dark:text-gray-200">{result.description}</p>
          </div>
          <div className="text-left mt-6 w-full">
            <h4 className="text-2xl font-bold text-gray-900 dark:text-white mb-2">Plan de Acci√≥n y Recomendaciones:</h4>
            <ul className="list-disc list-inside space-y-2 text-lg text-gray-700 dark:text-gray-300">
              {result.plan.map((item, index) => <li key={index}>{item}</li>)}
            </ul>
          </div>
          <button onClick={onRestart} className="mt-8 px-6 py-3 text-lg font-semibold text-white bg-indigo-600 rounded-full shadow-lg hover:bg-indigo-700">Volver a Empezar</button>
        </div>
      );
    }
    
    // --- COMPONENTE PRINCIPAL (ORQUESTADOR) ---
    function App() {
      const { useState } = React;
      const [quizState, setQuizState] = useState('welcome');
      const [submissionStatus, setSubmissionStatus] = useState('idle');
      const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
      const [score, setScore] = useState(0);

      const handleStartQuiz = () => setQuizState('quiz');

      const handleAnswer = (scoreValue) => {
        setScore(prev => prev + scoreValue);
        const nextQuestion = currentQuestionIndex + 1;
        if (nextQuestion < quizData.length) {
          setCurrentQuestionIndex(nextQuestion);
        } else {
          setQuizState('user_info');
        }
      };

      const handleSubmitResults = (name, email, school, grade) => {
        setQuizState('results');
        setSubmissionStatus('sending');
        const finalResult = getResultForScore(score);
        
        const formData = new FormData();
        formData.append('Nombre', name);
        formData.append('Email', email);
        formData.append('Institucion', school);
        formData.append('Grado', grade);
        formData.append('Puntaje', score);
        formData.append('Resultado', finalResult.title);

        if (SCRIPT_URL && SCRIPT_URL !== "URL_DE_TU_SCRIPT_DE_GOOGLE_AQU√ç") {
          fetch(SCRIPT_URL, { method: 'POST', body: formData });
          setSubmissionStatus('success');
        } else {
          console.error("Error: SCRIPT_URL no est√° definida.");
          setSubmissionStatus('error');
        }
      };

      const handleRestartQuiz = () => {
        setQuizState('welcome');
        setSubmissionStatus('idle');
        setCurrentQuestionIndex(0);
        setScore(0);
      };

      const renderContent = () => {
        switch (quizState) {
          case 'quiz': return <QuizScreen key={currentQuestionIndex} question={quizData[currentQuestionIndex]} onAnswer={handleAnswer} questionIndex={currentQuestionIndex} totalQuestions={quizData.length} />;
          case 'user_info': return <UserInfoScreen onSubmit={handleSubmitResults} />;
          case 'results': return <ResultsScreen score={score} result={getResultForScore(score)} submissionStatus={submissionStatus} onRestart={handleRestartQuiz} />;
          default: return <WelcomeScreen onStartQuiz={handleStartQuiz} />;
        }
      };

      return <div className="flex items-center justify-center min-h-screen p-4">{renderContent()}</div>;
    }
    
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>